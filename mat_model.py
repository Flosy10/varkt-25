from math import *
import matplotlib.pyplot as plt

def g(h):
    G = 6.67408 * 10 ** -11
    M = 5.2915793 * 10 ** 22
    R = 600_000
    g = G * M / (R + h) ** 2
    return g

def F_sopr(h, v):
    if h >= 70_000: return 0
    return (cf * (p * s) * v ** 2) / 2


Mr = 33165
M0 = 6500 * 3
T1 = 42.2
k = (Mr - M0) / T1

s = (0.0021) ** 2 * pi
cf = 0.48
m0 = 33165

h = 0
vx = 0
vy = 0
v = (vx ** 2 + vy ** 2) ** 0.5

Ft = 3 * 275_000

t = 0

T = 75
pa = 1.225
p = pa - t * pa / T

v_res = []
h_res = []
m_res = []
t_res = []

while h < 2800:
    t += 1
    p = pa - t * pa / T
    ay = abs((Ft - F_sopr(h, v) - m0 * g(h))) * 1 / m0
    vy += ay
    h = h + vy + ay / 2

    v = (vx ** 2 + vy ** 2) ** 0.5
    m0 = m0 - k
    v_res.append(v)
    h_res.append(h)
    m_res.append(m0)
    t_res.append(t)

b = 90
while h < 16500:
    b = 90 * (1 - h / 150_000)
    t += 1
    p = pa - t * pa / T
    ax = abs((Ft - F_sopr(h, v) - m0 * g(h)) * cos(b / 180 * pi) / m0)
    ay = abs((Ft - F_sopr(h, v) - m0 * g(h)) * sin(b / 180 * pi) / m0)
    vx += ax
    vy += ay
    h = h + vy + ay / 2
    v = (vx ** 2 + vy ** 2) ** 0.5
    m0 = m0 - k
    v_res.append(v)
    h_res.append(h)
    m_res.append(m0)
    t_res.append(t)

m0 = 33165 - 7650 * 3
M0 = 2000
T2 = 75
k = (m0 - M0) / T2
n = 253.5 / 292.5 * 9.81
s = (0.0021) ** 2 * pi
Ft = 253_500

b = 90
while h < 50_000:
    b = 90 * (1 - h / 150_000)
    t += 1
    p = pa - t * pa / T
    ax = abs((Ft - F_sopr(h, v) - m0 * g(h)) * cos(b / 180 * pi) / m0)
    ay = abs((Ft - F_sopr(h, v) - m0 * g(h)) * sin(b / 180 * pi) / m0)
    vx += ax
    vy += ay
    h = h + vy + ay / 2

    v = (vx ** 2 + vy ** 2) ** 0.5
    m0 = m0 - k
    v_res.append(v)
    h_res.append(h)
    m_res.append(m0)
    t_res.append(t)

while t < 300:
    t += 1
    b = 90 * (1 - h / 150_000)
    p = pa - t * pa / T
    ax = (Ft - F_sopr(h, v) - m0 * g(h)) * cos(b / 180 * pi) / m0
    ay = (Ft - F_sopr(h, v) - m0 * g(h)) * sin(b / 180 * pi) / m0
    if t >= 75 and t <= 268:
        ax = 0
        ay = -g(h) / 2
    if t > 268:
        ay = -g(h)
    vx += ax
    vy += ay
    if t >= 75 and t <= 268:
        h = h + vy / 4 + ay / 2
    else:
        h = h + vy + ay / 2

    v = (vx ** 2 + vy ** 2) ** 0.5
    if t >= 75 and t <= 268:
        m0 = m0
    else:
        m0 = m0 - k
    v_res.append(v)
    h_res.append(h)
    m_res.append(m0)
    t_res.append(t)


time_velocity = [1.0, 2.1, 3.1, 4.1, 5.2, 6.2, 7.2, 8.2, 9.3, 10.3, 11.3, 12.3, 13.4, 14.4, 15.4, 16.5, 17.5, 18.5, 19.6, 20.6, 21.7, 22.7, 23.7, 24.7, 25.8, 26.8, 27.8, 28.8, 29.9, 30.9, 31.9, 33.0, 34.0, 35.0, 36.1, 37.1, 38.2, 39.2, 40.2, 41.2, 45.3, 46.4, 47.4, 48.5, 49.5, 50.5, 51.6, 52.6, 53.6, 54.6, 55.6, 56.7, 57.7, 58.7, 59.8, 60.8, 61.8, 62.9, 63.9, 65.0, 66.0, 67.0, 68.1, 69.1, 70.1, 71.1, 72.2, 73.2, 74.2, 75.2, 77.0, 78.0, 79.1, 80.1, 81.1, 82.1, 83.1, 84.1, 85.2, 86.2, 87.2, 88.2, 89.2, 90.3, 91.3, 92.3, 93.3, 94.3, 95.3, 96.4, 97.4, 98.4, 99.4, 100.4, 101.4, 102.5, 103.5, 104.5, 105.5, 106.5, 107.5, 108.6, 109.6, 110.6, 111.6, 112.6, 113.7, 114.7, 115.7, 116.7, 117.7, 118.8, 119.8, 120.8, 121.8, 122.8, 123.9, 124.9, 125.9, 126.9, 127.9, 128.9, 129.9, 130.9, 132.0, 133.0, 134.0, 135.0, 136.0, 137.0, 138.1, 139.1, 140.1, 141.2, 142.2, 143.2, 144.2, 145.2, 146.2, 147.2, 148.3, 149.3, 150.3, 151.3, 152.3, 153.4, 154.4, 155.4, 156.4, 157.4, 158.5, 159.5, 160.5, 161.5, 162.5, 163.6, 164.6, 165.6, 166.6, 167.6, 168.6, 169.7, 170.7, 171.7, 172.7, 173.8, 174.8, 175.8, 176.8, 177.8, 178.8, 179.9, 180.9, 181.9, 182.9, 183.9, 185.0, 186.0, 187.0, 188.0, 189.1, 190.1, 191.1, 192.1, 193.1, 194.1, 195.2, 196.2, 197.2, 198.2, 199.2, 200.2, 201.3, 202.3, 203.3, 204.3, 205.4, 206.4, 207.4, 208.4, 209.4, 210.5, 211.5, 212.5, 213.5, 214.5, 215.5, 216.5, 217.6, 218.6, 221.6, 222.7, 223.7, 224.7, 225.7, 226.8, 227.9, 228.9, 230.0, 231.0, 232.0, 233.0, 234.1, 235.1, 236.1, 237.1, 238.2, 239.2, 240.3, 241.3, 242.3, 243.5, 244.5, 245.5, 246.6, 247.6, 248.7, 249.7, 250.8, 251.8, 252.8, 253.8, 254.9, 255.9, 256.9, 258.1, 259.1, 260.2, 261.3, 262.3, 263.4, 264.4, 265.4, 266.5, 267.5, 268.5, 269.7, 270.7, 271.8, 272.8, 273.9, 274.9, 275.9, 277.0, 278.0, 279.0, 280.1, 281.1, 282.1, 283.1, 284.2, 285.2, 286.2, 287.3, 288.3, 289.3, 290.4, 291.4, 292.5, 293.0]
velocity_ksp = [18.82, 32.88, 47.55, 61.99, 76.75, 91.83, 107.22, 123.27, 139.36, 155.82, 172.67, 189.94, 208.32, 226.37, 244.72, 263.73, 283.04, 302.28, 321.65, 341.37, 361.58, 381.11, 401.14, 421.46, 441.9, 463.05, 485.62, 508.87, 535.49, 562.88, 591.94, 623.17, 654.7, 689.62, 724.7, 762.74, 801.71, 842.44, 884.28, 928.15, 995.83, 1009.13, 1022.28, 1035.62, 1048.84, 1062.78, 1077.2, 1091.78, 1106.78, 1122.45, 1137.83, 1154.11, 1170.63, 1187.05, 1203.96, 1220.68, 1341.91, 1365.33, 1383.02, 1403.49, 1424.0, 1444.19, 1464.79, 1485.01, 1505.24, 1525.61, 1546.85, 1569.46, 1592.55, 1617.04, 1630.49, 1624.85, 1619.57, 1614.34, 1609.15, 1604.0, 1598.88, 1593.91, 1588.86, 1583.85, 1578.88, 1573.93, 1569.02, 1564.14, 1559.3, 1554.58, 1549.79, 1545.04, 1540.31, 1535.62, 1530.95, 1526.31, 1521.79, 1517.21, 1512.65, 1508.12, 1503.62, 1499.15, 1494.7, 1490.28, 1485.98, 1481.61, 1477.27, 1472.96, 1468.67, 1464.42, 1460.18, 1455.98, 1451.8, 1447.65, 1443.52, 1439.42, 1435.35, 1431.3, 1427.28, 1423.29, 1419.32, 1415.37, 1411.53, 1407.64, 1403.85, 1400.01, 1396.27, 1392.48, 1388.79, 1385.05, 1381.34, 1377.65, 1374.06, 1370.36, 1366.53, 1363.02, 1359.46, 1356.0, 1352.49, 1349.01, 1345.55, 1342.12, 1338.78, 1335.4, 1332.04, 1328.71, 1325.4, 1322.12, 1318.86, 1315.63, 1312.43, 1309.25, 1306.09, 1302.96, 1299.86, 1296.78, 1293.73, 1290.7, 1287.69, 1284.77, 1281.82, 1278.89, 1275.99, 1273.17, 1270.31, 1267.43, 1264.68, 1261.9, 1259.15, 1256.42, 1253.72, 1251.05, 1248.39, 1245.77, 1243.17, 1240.59, 1238.04, 1235.52, 1233.02, 1230.54, 1228.09, 1225.67, 1223.27, 1220.9, 1218.55, 1216.23, 1213.98, 1211.71, 1209.46, 1207.24, 1205.0, 1202.84, 1200.69, 1198.62, 1196.52, 1194.46, 1192.42, 1190.4, 1188.41, 1186.41, 1184.47, 1182.56, 1180.68, 1178.86, 1177.02, 1175.21, 1173.43, 1171.67, 1169.98, 1168.27, 1166.59, 1164.94, 1163.32, 1161.72, 1157.13, 1155.58, 1154.14, 1152.69, 1151.25, 1149.83, 1148.33, 1147.03, 1145.62, 1144.34, 1143.11, 1141.88, 1140.66, 1139.48, 1138.33, 1137.23, 1136.06, 1134.97, 1133.93, 1132.9, 1131.89, 1130.73, 1129.92, 1129.01, 1128.09, 1127.23, 1126.34, 1125.55, 1124.78, 1124.04, 1123.33, 1122.65, 1121.98, 1121.34, 1120.75, 1120.12, 1119.57, 1119.03, 1118.51, 1118.05, 1117.58, 1117.17, 1116.79, 1116.45, 1116.12, 1115.83, 1133.73, 1173.35, 1213.54, 1254.34, 1295.74, 1337.76, 1380.41, 1423.72, 1466.83, 1510.61, 1555.94, 1602.0, 1647.89, 1694.51, 1741.89, 1791.01, 1840.0, 1890.8, 1941.5, 1995.13, 2048.71, 2103.29, 2158.9, 2187.1]
mass_ksp = [32511.65,32057.15,31593.90,31148.14,30702.38,30256.62,29810.86,29356.36,28910.59,28464.83,28019.07,27573.31,27110.07,26664.30,26218.54,25764.04,25309.54,24863.78,24418.02,23963.52,23500.27,23054.51,22600.01,22145.51,21699.74,21253.98,20799.48,20362.46,19899.22,19453.46,19007.69,18553.19,18116.17,17652.93,17207.17,16743.92,16289.42,15834.92,15389.16,14943.40,9583.62,9493.47,9399.80,9306.12,9215.97,9124.06,9032.15,8942.01,8851.87,8759.96,8671.58,8579.67,8487.76,8397.62,8305.71,8215.56,8125.42,8019.37,7939.83,7847.92,7756.01,7665.87,7573.96,7483.82,7393.67,7303.53,7213.39,7121.48,7031.33,6939.42,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6829.84,6737.93,6646.02,6554.11,6462.20,6370.29,6278.38,6186.47,6096.32,6006.18,5914.27,5822.36,5732.22,5642.07,5551.93,5460.02,5369.88,5277.97,5187.82,5094.15,5002.24,4910.33,4818.41,4772.46]
altitude_ksp = [80.11, 82.56, 87.66, 89.75, 97.15, 103.06, 112.76, 117.21, 129.89, 138.52, 153.17, 158.73, 176.61, 189.54, 210.47, 217.86, 239.91, 255.07, 279.88, 289.04, 317.78, 338.0, 366.28, 379.14, 411.58, 435.53, 475.24, 488.23, 526.25, 551.8, 595.22, 610.14, 656.26, 682.76, 732.07, 748.96, 801.03, 833.88, 883.05, 901.93, 956.68, 996.48, 1057.97, 1078.95, 1136.08, 1183.77, 1247.87, 1270.97, 1333.78, 1382.04, 1460.52, 1485.83, 1563.28, 1616.19, 1697.48, 1725.09, 1809.47, 1867.03, 1955.32, 1990.29, 2081.86, 2144.23, 2239.77, 2277.58, 2370.9, 2432.44, 2540.87, 2575.67, 2675.76, 2741.69, 2851.57, 2888.75, 2995.57, 3072.3, 3189.45, 3229.05, 3349.49, 3424.32, 3541.78, 3576.75, 3704.23, 3797.86, 3929.65, 4041.39, 4170.14, 4262.36, 4410.68, 4458.1, 4618.21, 4715.77, 4855.93, 4905.93, 5057.66, 5177.45, 5333.76, 5395.25, 5546.24, 5663.28, 5836.85, 5901.56, 6088.73, 6212.24, 6395.47, 6454.01, 6651.56, 6792.1, 7027.1, 7078.88, 7256.82, 7384.19, 7578.05, 7632.51, 7819.66, 7964.89, 8169.05, 8226.41, 8435.23, 8576.52, 8803.64, 8864.12, 9071.98, 9220.79, 9460.02, 9536.49, 9755.62, 9912.49, 10137.89, 10218.33, 10462.48, 10627.62, 10878.93, 10963.68, 11206.44, 11394.77, 11659.42, 11748.65, 12019.41, 12310.27, 12574.98, 12669.42, 12955.98, 13149.73, 13427.97, 13527.23, 13828.4, 14032.01, 14324.39, 14428.69, 14727.42, 14941.15, 15266.26, 15357.54, 15689.68, 15933.05, 19745.28, 19863.78, 20200.29, 20418.64, 20776.93, 20896.62, 21236.42, 21456.81, 21818.29, 21939.01, 22281.65, 22503.84, 22847.95, 22969.61, 23294.56, 23559.13, 24026.27, 24148.86, 24517.25, 24663.34, 24992.1, 25115.56, 25465.92, 25693.04, 26044.7, 26148.27, 26687.94, 26937.61, 27291.97, 27396.33, 27793.5, 28023.85, 28401.44, 28527.49, 28885.07, 29116.82, 29496.67, 29623.45, 29983.11, 30216.18, 30598.13, 30725.61, 31087.19, 31321.47, 31449.36, 31705.34, 31812.09, 32047.08, 32175.36, 32410.69, 32432.1, 32753.38, 32882.01, 33139.43, 33246.75, 33504.5, 33633.45, 33870.0, 33999.1, 34257.45, 34386.7, 34623.76, 34731.57, 34968.85, 35098.34, 35335.83, 35465.42, 35703.1, 35832.79, 36092.27, 36222.05, 36460.05, 36589.91, 36849.69, 36957.96, 37217.85, 37347.83, 37586.15, 37694.5, 37954.56, 38062.93, 38323.04, 38431.42, 38669.87, 38799.93, 39038.37, 39168.43, 39428.51, 39558.54, 39796.9, 39926.89, 40186.83, 40316.77, 40554.94, 40684.82, 40922.87, 41074.3, 41333.8, 41463.5, 41701.19, 41830.78, 42089.83, 42219.29, 42607.37, 42736.62, 42994.97, 43124.05, 43360.55, 43489.47, 43725.63, 43854.35, 44090.15, 44218.67, 44475.47, 44603.75, 44860.06, 44988.09, 45243.89, 45371.65, 45605.63, 45733.13, 45966.62, 46093.84, 46326.83, 46453.78, 46707.41, 46834.09, 47087.16, 47213.56, 47466.09, 47592.22, 47823.23, 47949.1, 48179.63, 48305.25, 48556.23, 48681.58, 48932.02, 49057.11, 49307.02, 49431.85, 49660.47, 49785.06, 50013.23, 149879.11]
time_ksp = [0.24, 0.47, 0.84, 0.95, 1.32, 1.55, 1.9, 2.03, 2.4, 2.62, 2.95, 3.07, 3.43, 3.67, 4.03, 4.16, 4.49, 4.71, 5.05, 5.17, 5.53, 5.77, 6.1, 6.23, 6.57, 6.82, 7.19, 7.3, 7.65, 7.87, 8.23, 8.35, 8.71, 8.92, 9.27, 9.4, 9.75, 9.97, 10.3, 10.42, 10.75, 11.0, 11.35, 11.47, 11.81, 12.05, 12.39, 12.51, 12.84, 13.07, 13.45, 13.58, 13.94, 14.17, 14.54, 14.65, 15.03, 15.25, 15.62, 15.75, 16.11, 16.36, 16.72, 16.85, 17.19, 17.43, 17.79, 17.91, 18.25, 18.48, 18.83, 18.95, 19.29, 19.54, 19.89, 20.01, 20.37, 20.59, 20.93, 21.04, 21.4, 21.65, 22.02, 22.31, 22.66, 22.89, 23.28, 23.4, 23.79, 24.03, 24.37, 24.49, 24.85, 25.12, 25.5, 25.61, 25.96, 26.24, 26.63, 26.75, 27.13, 27.39, 27.8, 27.92, 28.32, 28.62, 29.06, 29.17, 29.51, 29.74, 30.1, 30.21, 30.54, 30.8, 31.16, 31.27, 31.62, 31.88, 32.24, 32.34, 32.69, 32.92, 33.3, 33.42, 33.77, 34.0, 34.34, 34.47, 34.82, 35.07, 35.43, 35.54, 35.89, 36.14, 36.5, 36.63, 36.98, 37.36, 37.7, 37.83, 38.19, 38.42, 38.77, 38.88, 39.24, 39.49, 39.82, 39.94, 40.29, 40.52, 40.88, 40.99, 41.34, 41.6, 45.54, 45.66, 46.0, 46.22, 46.58, 46.7, 47.04, 47.27, 47.62, 47.74, 48.08, 48.3, 48.64, 48.76, 49.09, 49.34, 49.7, 49.83, 50.18, 50.41, 50.75, 50.86, 51.2, 51.42, 51.76, 51.87, 52.38, 52.62, 52.96, 53.07, 53.44, 53.66, 54.02, 54.13, 54.49, 54.71, 55.05, 55.18, 55.52, 55.74, 56.1, 56.22, 56.56, 56.79, 56.9, 57.14, 57.24, 57.46, 57.58, 57.81, 57.92, 58.16, 58.27, 58.51, 58.62, 58.85, 58.97, 59.2, 59.32, 59.55, 59.67, 59.89, 60.0, 60.22, 60.33, 60.56, 60.67, 60.9, 61.01, 61.25, 61.37, 61.59, 61.72, 61.95, 62.06, 62.3, 62.41, 62.63, 62.74, 62.97, 63.07, 63.31, 63.42, 63.64, 63.76, 63.97, 64.09, 64.34, 64.45, 64.68, 64.8, 65.04, 65.15, 65.37, 65.5, 65.73, 65.85, 66.1, 66.21, 66.44, 66.55, 66.8, 66.92, 67.28, 67.4, 67.64, 67.75, 67.98, 68.09, 68.32, 68.43, 68.65, 68.77, 69.02, 69.14, 69.37, 69.49, 69.74, 69.85, 70.07, 70.19, 70.42, 70.53, 70.76, 70.88, 71.12, 71.24, 71.47, 71.59, 71.84, 71.95, 72.17, 72.29, 72.52, 72.63, 72.87, 73.0, 73.23, 73.35, 73.6, 73.72, 73.94, 74.05, 74.27, 290.74]

plt.figure(figsize=(3, 1.5), layout='constrained')
plt.plot(t_res, h_res, label='высота мат.модель')
plt.plot(time_ksp, altitude_ksp, label = 'высота ksp')
plt.xlabel('время полета')
plt.ylabel('высота полета')
plt.title("График зависимости высоты полета от времени")
plt.legend()

plt.figure(figsize=(3, 1.5), layout='constrained')
plt.plot(t_res, v_res, label='скорость мат.модель')
plt.plot(time_velocity, velocity_ksp, label = 'скорость ksp')
plt.xlabel('время полета')
plt.ylabel('скорость полета')
plt.title("График зависимости скорости полета от времени")
plt.legend()


plt.figure(figsize=(3, 1.5), layout= 'constrained')
plt.plot(t_res, m_res, label= 'масса мат.модель')
plt.plot(time_velocity, mass_ksp, label = 'масса ksp')
plt.xlabel('время полета')
plt.ylabel('масса ракеты')
plt.title("График зависимости массы ракеты от времени")
plt.legend()
plt.show()