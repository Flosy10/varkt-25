from math import *
import matplotlib.pyplot as plt

def g(h):
    G = 6.67408 * 10 ** -11
    M = 5.2915793 * 10 ** 22
    R = 600_000
    g = G * M / (R + h) ** 2
    return g


def F_sopr(h, v):
    if h >= 70_000: return 0
    global cf
    global p
    global s
    return (cf * (p * s) * v ** 2) / 2


Mr = 33165
M0 = 6500 * 3
T1 = 42.2
k = (Mr - M0) / T1

s = 2.1 ** 2 * pi
cf = 0.48
m0 = 33165

alpha = 90
h = 0
vx = 0
vy = 0
v = (vx ** 2 + vy ** 2) ** 0.5

Ft = 3 * 275_000

t = 0

T = 75
pa = 1.225
p = pa - t * pa / T
v_res = []
h_res = []
m_res = []
t_res = []

while h < 2800:
    t += 1
    p = pa - t * pa / T

    ay = abs((Ft - F_sopr(h, v) ) * 1 - m0 * g(h))/ m0
    vy += ay
    h = h + vy + ay / 2

    v = (vx ** 2 + vy ** 2) ** 0.5
    m0 = m0 - k
    v_res.append(v)
    h_res.append(h)
    m_res.append(m0)
    t_res.append(t)

b = 0
alpha0 = alpha
alpha1 = 85
tpov = 20
t_nachalo_povorota = 0
if 2800 <= h <= 2995:
    t_nachalo_povorota = t

while 2800 <= h < 16_500:
    b = (alpha0 - alpha1)/tpov
    alpha = alpha0 - (b * (t - t_nachalo_povorota))
    t += 1
    p = pa - t * pa / T
    ax = abs((Ft - F_sopr(h, v)) * cos(alpha / 180 * pi) / m0)
    ay = abs((Ft - F_sopr(h, v) - m0 * g(h)) * sin(alpha / 180 * pi) / m0)
    vx += ax
    vy += ay
    h = h + vy + ay / 2
    v = (vx ** 2 + vy ** 2) ** 0.5
    m0 = m0 - k
    v_res.append(v)
    h_res.append(h)
    m_res.append(m0)
    t_res.append(t)

m0 = 33165 - 7650 * 3
M0 = 2000
T2 = 75
k = (m0 - M0) / T2
s = 0.21 ** 2 * pi
Ft = 253_500

b = 0

if 16_500 <= h <= 16_800:
    t_nachalo_povorota = t
    tpov = 34

alpha0 = alpha
alpha1 = 0
while 16_500 <= h < 50_000:
    b = (alpha0 - alpha1) / tpov
    alpha = alpha0 - (b * (t - t_nachalo_povorota))
    t += 1
    p = pa - t * pa / T
    ax = abs((Ft * cos(alpha / 180 * pi) - F_sopr(h, v))  / m0)
    ay = abs((Ft - F_sopr(h, v) - m0 * g(h)) * sin(alpha / 180 * pi) / m0)
    vx += ax
    vy += ay
    h = h + vy + ay / 2

    v = (vx ** 2 + vy ** 2) ** 0.5
    m0 = m0 - k
    v_res.append(v)
    h_res.append(h)
    m_res.append(m0)
    t_res.append(t)

while h >= 50_000 and t < 293:
    t += 1
    b = 90 * (1 - h / 150_000)
    p = pa - t * pa / T
    ax = 0
    ay = -g(h)
    if t >= 75 and t <= 268:
        ax = 0
        ay = -g(h)
    if t > 268:
        ax = Ft / m0
        ay = -g(h)
    vx += ax
    vy += ay
    if t >= 75 and t <= 268:
        h = h + vy  + ay / 2
    else:
        h = h + vy + ay / 2

    v = (vx ** 2 + vy ** 2) ** 0.5
    if t >= 75 and t <= 268:
        m0 = m0
    else:
        m0 = m0 - k
    v_res.append(v)
    h_res.append(h)
    m_res.append(m0)
    t_res.append(t)


time_ksp = [1.0, 2.1, 3.1, 4.1, 5.2, 6.2, 7.2, 8.2, 9.3, 10.3, 11.3, 12.3, 13.4, 14.4, 15.4, 16.5, 17.5, 18.5, 19.6, 20.6, 21.7, 22.7, 23.7, 24.7, 25.8, 26.8, 27.8, 28.8, 29.9, 30.9, 31.9, 33.0, 34.0, 35.0, 36.1, 37.1, 38.2, 39.2, 40.2, 41.2, 45.3, 46.4, 47.4, 48.5, 49.5, 50.5, 51.6, 52.6, 53.6, 54.6, 55.6, 56.7, 57.7, 58.7, 59.8, 60.8, 61.8, 62.9, 63.9, 65.0, 66.0, 67.0, 68.1, 69.1, 70.1, 71.1, 72.2, 73.2, 74.2, 75.2, 77.0, 78.0, 79.1, 80.1, 81.1, 82.1, 83.1, 84.1, 85.2, 86.2, 87.2, 88.2, 89.2, 90.3, 91.3, 92.3, 93.3, 94.3, 95.3, 96.4, 97.4, 98.4, 99.4, 100.4, 101.4, 102.5, 103.5, 104.5, 105.5, 106.5, 107.5, 108.6, 109.6, 110.6, 111.6, 112.6, 113.7, 114.7, 115.7, 116.7, 117.7, 118.8, 119.8, 120.8, 121.8, 122.8, 123.9, 124.9, 125.9, 126.9, 127.9, 128.9, 129.9, 130.9, 132.0, 133.0, 134.0, 135.0, 136.0, 137.0, 138.1, 139.1, 140.1, 141.2, 142.2, 143.2, 144.2, 145.2, 146.2, 147.2, 148.3, 149.3, 150.3, 151.3, 152.3, 153.4, 154.4, 155.4, 156.4, 157.4, 158.5, 159.5, 160.5, 161.5, 162.5, 163.6, 164.6, 165.6, 166.6, 167.6, 168.6, 169.7, 170.7, 171.7, 172.7, 173.8, 174.8, 175.8, 176.8, 177.8, 178.8, 179.9, 180.9, 181.9, 182.9, 183.9, 185.0, 186.0, 187.0, 188.0, 189.1, 190.1, 191.1, 192.1, 193.1, 194.1, 195.2, 196.2, 197.2, 198.2, 199.2, 200.2, 201.3, 202.3, 203.3, 204.3, 205.4, 206.4, 207.4, 208.4, 209.4, 210.5, 211.5, 212.5, 213.5, 214.5, 215.5, 216.5, 217.6, 218.6, 221.6, 222.7, 223.7, 224.7, 225.7, 226.8, 227.9, 228.9, 230.0, 231.0, 232.0, 233.0, 234.1, 235.1, 236.1, 237.1, 238.2, 239.2, 240.3, 241.3, 242.3, 243.5, 244.5, 245.5, 246.6, 247.6, 248.7, 249.7, 250.8, 251.8, 252.8, 253.8, 254.9, 255.9, 256.9, 258.1, 259.1, 260.2, 261.3, 262.3, 263.4, 264.4, 265.4, 266.5, 267.5, 268.5, 269.7, 270.7, 271.8, 272.8, 273.9, 274.9, 275.9, 277.0, 278.0, 279.0, 280.1, 281.1, 282.1, 283.1, 284.2, 285.2, 286.2, 287.3, 288.3, 289.3, 290.4, 291.4, 292.5, 293.0]
velocity_ksp = [18.82, 32.88, 47.55, 61.99, 76.75, 91.83, 107.22, 123.27, 139.36, 155.82, 172.67, 189.94, 208.32, 226.37, 244.72, 263.73, 283.04, 302.28, 321.65, 341.37, 361.58, 381.11, 401.14, 421.46, 441.9, 463.05, 485.62, 508.87, 535.49, 562.88, 591.94, 623.17, 654.7, 689.62, 724.7, 762.74, 801.71, 842.44, 884.28, 928.15, 995.83, 1009.13, 1022.28, 1035.62, 1048.84, 1062.78, 1077.2, 1091.78, 1106.78, 1122.45, 1137.83, 1154.11, 1170.63, 1187.05, 1203.96, 1220.68, 1341.91, 1365.33, 1383.02, 1403.49, 1424.0, 1444.19, 1464.79, 1485.01, 1505.24, 1525.61, 1546.85, 1569.46, 1592.55, 1617.04, 1630.49, 1624.85, 1619.57, 1614.34, 1609.15, 1604.0, 1598.88, 1593.91, 1588.86, 1583.85, 1578.88, 1573.93, 1569.02, 1564.14, 1559.3, 1554.58, 1549.79, 1545.04, 1540.31, 1535.62, 1530.95, 1526.31, 1521.79, 1517.21, 1512.65, 1508.12, 1503.62, 1499.15, 1494.7, 1490.28, 1485.98, 1481.61, 1477.27, 1472.96, 1468.67, 1464.42, 1460.18, 1455.98, 1451.8, 1447.65, 1443.52, 1439.42, 1435.35, 1431.3, 1427.28, 1423.29, 1419.32, 1415.37, 1411.53, 1407.64, 1403.85, 1400.01, 1396.27, 1392.48, 1388.79, 1385.05, 1381.34, 1377.65, 1374.06, 1370.36, 1366.53, 1363.02, 1359.46, 1356.0, 1352.49, 1349.01, 1345.55, 1342.12, 1338.78, 1335.4, 1332.04, 1328.71, 1325.4, 1322.12, 1318.86, 1315.63, 1312.43, 1309.25, 1306.09, 1302.96, 1299.86, 1296.78, 1293.73, 1290.7, 1287.69, 1284.77, 1281.82, 1278.89, 1275.99, 1273.17, 1270.31, 1267.43, 1264.68, 1261.9, 1259.15, 1256.42, 1253.72, 1251.05, 1248.39, 1245.77, 1243.17, 1240.59, 1238.04, 1235.52, 1233.02, 1230.54, 1228.09, 1225.67, 1223.27, 1220.9, 1218.55, 1216.23, 1213.98, 1211.71, 1209.46, 1207.24, 1205.0, 1202.84, 1200.69, 1198.62, 1196.52, 1194.46, 1192.42, 1190.4, 1188.41, 1186.41, 1184.47, 1182.56, 1180.68, 1178.86, 1177.02, 1175.21, 1173.43, 1171.67, 1169.98, 1168.27, 1166.59, 1164.94, 1163.32, 1161.72, 1157.13, 1155.58, 1154.14, 1152.69, 1151.25, 1149.83, 1148.33, 1147.03, 1145.62, 1144.34, 1143.11, 1141.88, 1140.66, 1139.48, 1138.33, 1137.23, 1136.06, 1134.97, 1133.93, 1132.9, 1131.89, 1130.73, 1129.92, 1129.01, 1128.09, 1127.23, 1126.34, 1125.55, 1124.78, 1124.04, 1123.33, 1122.65, 1121.98, 1121.34, 1120.75, 1120.12, 1119.57, 1119.03, 1118.51, 1118.05, 1117.58, 1117.17, 1116.79, 1116.45, 1116.12, 1115.83, 1133.73, 1173.35, 1213.54, 1254.34, 1295.74, 1337.76, 1380.41, 1423.72, 1466.83, 1510.61, 1555.94, 1602.0, 1647.89, 1694.51, 1741.89, 1791.01, 1840.0, 1890.8, 1941.5, 1995.13, 2048.71, 2103.29, 2158.9, 2187.1]
mass_ksp = [32511.65,32057.15,31593.90,31148.14,30702.38,30256.62,29810.86,29356.36,28910.59,28464.83,28019.07,27573.31,27110.07,26664.30,26218.54,25764.04,25309.54,24863.78,24418.02,23963.52,23500.27,23054.51,22600.01,22145.51,21699.74,21253.98,20799.48,20362.46,19899.22,19453.46,19007.69,18553.19,18116.17,17652.93,17207.17,16743.92,16289.42,15834.92,15389.16,14943.40,9583.62,9493.47,9399.80,9306.12,9215.97,9124.06,9032.15,8942.01,8851.87,8759.96,8671.58,8579.67,8487.76,8397.62,8305.71,8215.56,8125.42,8019.37,7939.83,7847.92,7756.01,7665.87,7573.96,7483.82,7393.67,7303.53,7213.39,7121.48,7031.33,6939.42,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6872.26,6829.84,6737.93,6646.02,6554.11,6462.20,6370.29,6278.38,6186.47,6096.32,6006.18,5914.27,5822.36,5732.22,5642.07,5551.93,5460.02,5369.88,5277.97,5187.82,5094.15,5002.24,4910.33,4818.41,4772.46]
altitude_ksp = [90.93, 117.93, 160.69, 216.69, 287.58, 373.68, 475.34, 595.33, 729.41, 880.09, 1047.77, 1232.85, 1444.08, 1665.93, 1906.36, 2170.93, 2455.43, 2754.13, 3072.55, 3417.52, 3790.24, 4169.11, 4575.87, 5003.43, 5443.29, 5904.04, 6396.05, 6891.48, 7442.38, 7999.28, 8584.08, 9210.64, 9843.36, 10547.91, 11260.13, 12037.36, 12838.19, 13678.51, 14542.73, 15448.42, 19287.43, 20277.42, 21315.65, 22362.17, 23376.69, 24418.47, 25467.59, 26503.56, 27546.35, 28616.38, 29651.45, 30733.99, 31822.23, 32894.56, 33992.41, 35072.84, 36156.21, 37433.42, 38392.43, 39500.95, 40608.74, 41693.51, 42796.69, 43874.71, 44947.67, 46014.43, 47074.54, 48148.82, 49196.08, 50257.59, 51999.48, 53084.26, 54102.43, 55114.47, 56120.42, 57120.31, 58114.18, 59082.73, 60064.74, 61040.79, 62010.92, 62975.13, 63933.45, 64885.89, 65832.48, 66754.84, 67689.88, 68619.12, 69542.57, 70460.27, 71372.25, 72278.48, 73161.37, 74056.25, 74945.42, 75828.88, 76706.65, 77578.75, 78445.18, 79305.95, 80144.36, 80993.95, 81837.93, 82676.3, 83509.07, 84336.25, 85157.85, 85973.89, 86784.36, 87589.29, 88388.69, 89182.56, 89970.91, 90753.75, 91531.1, 92302.97, 93069.35, 93830.27, 94570.97, 95321.09, 96051.23, 96790.59, 97510.19, 98238.83, 98947.93, 99665.88, 100378.45, 101085.65, 101773.77, 102483.96, 103215.57, 103887.65, 104567.89, 105229.63, 105899.33, 106563.73, 107222.83, 107876.63, 108512.49, 109155.84, 109793.92, 110426.74, 111054.3, 111676.62, 112293.7, 112905.55, 113512.17, 114113.58, 114709.78, 115300.78, 115886.57, 116467.18, 117042.61, 117612.87, 118177.95, 118726.94, 119281.81, 119831.53, 120376.1, 120905.01, 121439.42, 121979.03, 122492.87, 123011.92, 123525.87, 124034.72, 124538.47, 125037.13, 125530.71, 126019.21, 126502.64, 126981.01, 127454.31, 127922.56, 128385.75, 128843.9, 129297.01, 129745.09, 130188.14, 130626.16, 131059.16, 131487.14, 131901.87, 132319.94, 132733.01, 133141.08, 133552.01, 133950.0, 134343.01, 134723.48, 135106.63, 135484.82, 135858.03, 136226.29, 136589.59, 136954.91, 137308.2, 137656.55, 137999.96, 138331.84, 138665.47, 138994.17, 139317.95, 139636.79, 139944.61, 140253.72, 140557.91, 140857.2, 141151.57, 141441.04, 142269.38, 142549.94, 142809.79, 143069.99, 143330.27, 143585.48, 143854.64, 144090.0, 144343.49, 144573.48, 144794.23, 145014.58, 145234.25, 145444.78, 145650.46, 145847.39, 146058.62, 146253.15, 146439.03, 146623.57, 146803.07, 147010.51, 147156.59, 147317.59, 147482.79, 147636.75, 147794.12, 147935.02, 148073.71, 148204.86, 148331.17, 148452.66, 148571.56, 148685.45, 148790.23, 148902.08, 149000.73, 149096.12, 149189.61, 149271.3, 149353.99, 149427.02, 149493.78, 149555.73, 149613.93, 149665.18, 149720.62, 149763.77, 149802.59, 149837.23, 149867.85, 149894.62, 149917.71, 149937.29, 149953.27, 149966.25, 149976.6, 149984.24, 149989.32, 149992.23, 149993.21, 149992.47, 149990.28, 149986.84, 149982.56, 149977.47, 149972.16, 149966.86, 149961.94, 149959.72]

plt.figure(figsize=(12, 8), layout='constrained')
plt.plot(t_res, h_res, label='высота мат.модель')
plt.plot(time_ksp, altitude_ksp, label = 'высота ksp')
plt.xlabel('время полета')
plt.ylabel('высота полета')
plt.title("График зависимости высоты полета от времени")
plt.legend()

plt.figure(figsize=(12, 8), layout='constrained')
plt.plot(t_res, v_res, label='скорость мат.модель')
plt.plot(time_ksp, velocity_ksp, label = 'скорость ksp')
plt.xlabel('время полета')
plt.ylabel('скорость полета')
plt.title("График зависимости скорости полета от времени")
plt.legend()


plt.figure(figsize=(12, 8), layout= 'constrained')
plt.plot(t_res, m_res, label= 'масса мат.модель')
plt.plot(time_ksp, mass_ksp, label = 'масса ksp')
plt.xlabel('время полета')
plt.ylabel('масса ракеты')
plt.title("График зависимости массы ракеты от времени")
plt.legend()
plt.show()
